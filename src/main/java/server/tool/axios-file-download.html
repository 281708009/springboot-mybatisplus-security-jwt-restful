<html>
<head>
    <meta charset="UTF-8">
</head>
<body>
<button onclick="downLoadHandler()">下载</button>
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    function downLoadHandler() {
        axios.post('http://192.168.8.63:8093/waterDataHis/excel',  //1、替换此参数为接口中地址

            { responseType: 'arraybuffer',
                params:{
                    objId: 22,
                    areaId:1,
                    stationId:11,
                    timeStart:'2016-04-14 11:36:01',
                    timeEnd:'2016-04-14 11:36:01'
                }
            }                                 //！！此属性必须添加，否则接收表格为乱码！！
        )
            .then(function (res) {                                          //3、若以上发送请求部分写法格式不同，可直接从.then开始使用
                console.log(res);
                const content = res.data
                const blob = new Blob([content])
                const fileName = decodeURI(res.headers['content-disposition'].split('filename=')[1])
                if ('download' in document.createElement('a')) { // （非IE下载）
                    const elink = document.createElement('a')
                    elink.download = fileName
                    elink.style.display = 'none'
                    elink.href = URL.createObjectURL(blob)
                    document.body.appendChild(elink)
                    elink.click()
                    URL.revokeObjectURL(elink.href) // （释放URL 对象）
                    document.body.removeChild(elink)
                } else { // （IE10+下载）
                    navigator.msSaveBlob(blob, fileName)
                }
            })
            .catch(function (error) {
                console.log(error);
            });
    }
</script>
</html>